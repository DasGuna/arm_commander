<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial: Programming with the Arm Commander Package (Part 2) &mdash; Arm Commander 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=e031e9a9"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Tutorial: Programming with the Arm Commander Package (Part 1)" href="arm_commander_tutorial_part1.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Arm Commander
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="arm_commander.html">The Arm Commander Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="arm_commander_modules.html">The Arm Commander: API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="arm_commander_tutorial_part1.html">Tutorial: Programming with the Arm Commander Package (Part 1)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial: Programming with the Arm Commander Package (Part 2)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-named-joint-space-poses">The Named Joint-Space Poses</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adding-named-poses-to-the-arm-commander">Adding Named Poses to the Arm Commander</a></li>
<li class="toctree-l3"><a class="reference internal" href="#move-to-named-poses">Move to Named Poses</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#movement-according-to-different-reference-frames">Movement According to Different Reference Frames</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adding-collision-objects-as-anchors-of-reference-frames-and-move-based-on-a-custom-reference-frames">Adding Collision Objects as Anchors of Reference Frames and Move Based on a Custom Reference Frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exploiting-symmetry-in-movement-with-multiple-reference-frames">Exploiting Symmetry in Movement with Multiple Reference Frames</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#a-summary-of-move-functions">A Summary of Move Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#workspace-collision-avoidance-and-constraints">Workspace, Collision Avoidance, and Constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#define-a-workspace">Define a workspace</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#collision-avoidance">Collision Avoidance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#constraints">Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="#links">Links</a></li>
<li class="toctree-l2"><a class="reference internal" href="#author">Author</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Arm Commander</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tutorial: Programming with the Arm Commander Package (Part 2)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/arm_commander_tutorial_part2.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorial-programming-with-the-arm-commander-package-part-2">
<h1>Tutorial: Programming with the Arm Commander Package (Part 2)<a class="headerlink" href="#tutorial-programming-with-the-arm-commander-package-part-2" title="Permalink to this heading"></a></h1>
<p>Part 2 of the tutorial covers the the use of logical named poses, reference frames, symmetry of poses, and collision avoidance with arm commander package.</p>
<section id="the-named-joint-space-poses">
<h2>The Named Joint-Space Poses<a class="headerlink" href="#the-named-joint-space-poses" title="Permalink to this heading"></a></h2>
<p>The program file <code class="docutils literal notranslate"><span class="pre">named_poses/named_poses_1.py</span></code> illustrates the use of logical named poses for robot arm manipulation. The program demonstrates reading logical joint-space pose definitions from a yaml file, install these poses in the arm commander and uses these poses in move commands.</p>
<section id="adding-named-poses-to-the-arm-commander">
<h3>Adding Named Poses to the Arm Commander<a class="headerlink" href="#adding-named-poses-to-the-arm-commander" title="Permalink to this heading"></a></h3>
<p>The variable <code class="docutils literal notranslate"><span class="pre">config_file</span></code> specifies the location of the yaml file relative to the path of the example program file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># load config file and install the named poses</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">config_file</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">demo_config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">named_pose</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">demo_config</span><span class="p">[</span><span class="s1">&#39;scene&#39;</span><span class="p">][</span><span class="s1">&#39;named_poses&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">arm_commander</span><span class="o">.</span><span class="n">add_named_pose</span><span class="p">(</span><span class="n">named_pose</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">demo_config</span><span class="p">[</span><span class="s1">&#39;scene&#39;</span><span class="p">][</span><span class="s1">&#39;named_poses&#39;</span><span class="p">][</span><span class="n">named_pose</span><span class="p">])</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error in loading demo config file </span><span class="si">{</span><span class="n">config_file</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">raise</span>
</pre></div>
</div>
<p>The yaml file has defined two named joint-space poses, namely, <code class="docutils literal notranslate"><span class="pre">stow</span></code> and <code class="docutils literal notranslate"><span class="pre">home</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">robot</span><span class="p">:</span> <span class="n">panda</span>
<span class="n">moveit_group_name</span><span class="p">:</span> <span class="n">panda_arm</span>
<span class="n">scene</span><span class="p">:</span>
  <span class="n">named_poses</span><span class="p">:</span>
    <span class="n">stow</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.244</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.949</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.704</span><span class="p">,</span> <span class="mf">0.785</span><span class="p">]</span> <span class="c1"># from base</span>
    <span class="n">home</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.785</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.36</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.57</span><span class="p">,</span> <span class="mf">0.785</span><span class="p">]</span> <span class="c1"># from base</span>
</pre></div>
</div>
</section>
<section id="move-to-named-poses">
<h3>Move to Named Poses<a class="headerlink" href="#move-to-named-poses" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">arm_commander</span><span class="o">.</span><span class="n">wait_for_ready_to_move</span><span class="p">()</span>

<span class="c1"># send a move command to &#39;stow&#39;</span>
<span class="n">rospy</span><span class="o">.</span><span class="n">loginfo</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Move_to_named_pose: stow&#39;</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">move_to_named_pose</span><span class="p">(</span><span class="s1">&#39;stow&#39;</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>

<span class="c1"># send a move command to &#39;home&#39;</span>
<span class="n">rospy</span><span class="o">.</span><span class="n">loginfo</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Move_to_named_pose: home&#39;</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">move_to_named_pose</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="movement-according-to-different-reference-frames">
<h2>Movement According to Different Reference Frames<a class="headerlink" href="#movement-according-to-different-reference-frames" title="Permalink to this heading"></a></h2>
<p>Robot manipulation can use the world’s frame and other reference frames for movement definitions. The API of the arm commander has made the use of different reference frames programmatically simple. It offers functions to define custom reference frames through adding collision objects. Most of the move functions offers an optional parameter to change the reference frame to a custom one.</p>
<section id="adding-collision-objects-as-anchors-of-reference-frames-and-move-based-on-a-custom-reference-frames">
<h3>Adding Collision Objects as Anchors of Reference Frames and Move Based on a Custom Reference Frames<a class="headerlink" href="#adding-collision-objects-as-anchors-of-reference-frames-and-move-based-on-a-custom-reference-frames" title="Permalink to this heading"></a></h3>
<p>The example program <code class="docutils literal notranslate"><span class="pre">/framemove/frame_move_1.py</span></code> defines a box and use the box’s position [0.5, 0.2, 0.2] and orientation [0, 0, 0] to define a reference frame.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">arm_commander</span><span class="o">.</span><span class="n">add_box_to_scene</span><span class="p">(</span><span class="s1">&#39;area_1&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">xyz</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="n">rpy</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The name of the object is the name of the reference frame, and in this case it is <code class="docutils literal notranslate"><span class="pre">area_1</span></code>.</p></li>
<li><p>The dimension of the box is [0.4, 0.2, 0.01].</p></li>
<li><p>The position of the box is [0.5, 0.2, 0.2].</p></li>
<li><p>The orientation of the box is [0, 0, 0]</p></li>
</ul>
<p>The following snippet first moves to the origin [0.0, 0.0] of <code class="docutils literal notranslate"><span class="pre">area_1</span></code>, and then to the two opposite corners ([-0.2, -0.1] and [0.2 and 0.1]) of the the box.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># send a move command to a position in the frame of area_1</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reference_frame</span><span class="o">=</span><span class="s1">&#39;area_1&#39;</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
<span class="c1"># send a move command to a position in the frame of area_1</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reference_frame</span><span class="o">=</span><span class="s1">&#39;area_1&#39;</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
<span class="c1"># send a move command to a position in the frame of area_1</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reference_frame</span><span class="o">=</span><span class="s1">&#39;area_1&#39;</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference external image-reference" href="assets/ArmCommander-FrameMove1.gif"><img alt="Animation" src="assets/ArmCommander-FrameMove1.gif" /></a>
</section>
<section id="exploiting-symmetry-in-movement-with-multiple-reference-frames">
<h3>Exploiting Symmetry in Movement with Multiple Reference Frames<a class="headerlink" href="#exploiting-symmetry-in-movement-with-multiple-reference-frames" title="Permalink to this heading"></a></h3>
<p>The support for defining custom reference frames enables the division of the world into semantically rich subspaces. Movements defined relative to the origin and orientation of the subspace are more understandable to programmers, more reusable, and more resilience to changes.</p>
<p>For example, a set of movements defined in related to a workbench can be reused on workbenches in another location. The reference frame supports</p>
<p>The following defines two <strong>areas</strong> at different position and of a different orientation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">arm_commander</span><span class="o">.</span><span class="n">add_box_to_scene</span><span class="p">(</span><span class="s1">&#39;area_1&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">xyz</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="n">rpy</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">add_box_to_scene</span><span class="p">(</span><span class="s1">&#39;area_2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">xyz</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">rpy</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.57</span><span class="p">])</span>
</pre></div>
</div>
<p>The same movement commands can be used to produce the same relative movements within the two areas by specifying the reference frames.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># send a move command to a position in the frame of area_1</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reference_frame</span><span class="o">=</span><span class="s1">&#39;area_1&#39;</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
<span class="c1"># send a move command to the same relative position but in the frame of area_2</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reference_frame</span><span class="o">=</span><span class="s1">&#39;area_2&#39;</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>

<span class="c1"># send a move command to a position in the frame of area_1</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reference_frame</span><span class="o">=</span><span class="s1">&#39;area_1&#39;</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
<span class="c1"># send a move command to the same relative position but in the frame of area_2</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reference_frame</span><span class="o">=</span><span class="s1">&#39;area_2&#39;</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference external image-reference" href="assets/ArmCommander-FrameMove2.gif"><img alt="Animation" src="assets/ArmCommander-FrameMove2.gif" /></a>
</section>
</section>
<section id="a-summary-of-move-functions">
<h2>A Summary of Move Functions<a class="headerlink" href="#a-summary-of-move-functions" title="Permalink to this heading"></a></h2>
<p>The following table summarizes the support provided by each of the move functions. <code class="docutils literal notranslate"><span class="pre">Yes</span></code> indicates the parameter is supported.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Move Parameter</p></th>
<th class="head"><p>Cartesian</p></th>
<th class="head"><p>Reference Frame</p></th>
<th class="head"><p>Wait</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>move_to_named_pose</p></td>
<td><p>named_pose</p></td>
<td></td>
<td></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>move_displacement</p></td>
<td><p>dx, dy, dz</p></td>
<td></td>
<td></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>move_to_position</p></td>
<td><p>x, y, z</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>rotate_to_orientation</p></td>
<td><p>roll, pitch, yaw</p></td>
<td></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>move_to_pose</p></td>
<td><p>Pose, PoseStamped or list</p></td>
<td></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
</tbody>
</table>
</section>
<section id="workspace-collision-avoidance-and-constraints">
<h2>Workspace, Collision Avoidance, and Constraints<a class="headerlink" href="#workspace-collision-avoidance-and-constraints" title="Permalink to this heading"></a></h2>
<section id="define-a-workspace">
<h3>Define a workspace<a class="headerlink" href="#define-a-workspace" title="Permalink to this heading"></a></h3>
<p>A workspace can be defined in the arm commander for confining arm movements within a 3D bounding box. Internally, the workspace is constructed by 6 box-shaped collision objects, one on each of the 6 sides.
The following snipped can be found in the program file <code class="docutils literal notranslate"><span class="pre">/collision/workspace.py</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># add the workspace as a bounding box of xmin, ymin, zmin, zmax, ymax, zmax</span>
<span class="n">workspace_bbox</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">set_workspace_walls</span><span class="p">(</span><span class="o">*</span><span class="n">workspace_bbox</span><span class="p">)</span>
</pre></div>
</div>
<p>The workspace appears as a semi-transparent purple box in RViz. Move commands that result in any part of the robot arm infringing the workspace limits are aborted and a <code class="docutils literal notranslate"><span class="pre">TIMED_OUT</span></code> error is returned.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># move within the workspace</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
<span class="c1"># move outside the workspace</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.35</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="collision-avoidance">
<h2>Collision Avoidance<a class="headerlink" href="#collision-avoidance" title="Permalink to this heading"></a></h2>
<p>Avoidance of collision is supported by path planning of the underlying robot manipulation platform such as Moveit.
The program file <code class="docutils literal notranslate"><span class="pre">/collision/avoid_object.py</span></code> illustrates how the end-effector of the robot arm moves to the side and the top of a collision object.</p>
<a class="reference external image-reference" href="assets/ArmCommander-AvoidObject1.gif"><img alt="Animation" src="assets/ArmCommander-AvoidObject1.gif" /></a>
</section>
<section id="constraints">
<h2>Constraints<a class="headerlink" href="#constraints" title="Permalink to this heading"></a></h2>
<p>The program file <code class="docutils literal notranslate"><span class="pre">/collision/avoid_object_fix_rotation.py</span></code> illustrates the use of <code class="docutils literal notranslate"><span class="pre">OrientationConstraint</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">arm_commander</span><span class="o">.</span><span class="n">add_path_constraints</span><span class="p">(</span><span class="n">moveit_tools</span><span class="o">.</span><span class="n">create_path_orientation_constraint</span><span class="p">(</span><span class="n">arm_commander</span><span class="o">.</span><span class="n">get_end_effector_link</span><span class="p">(),</span>
                <span class="n">arm_commander</span><span class="o">.</span><span class="n">pose_in_frame</span><span class="p">(),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">6.28</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">))</span>

<span class="c1"># move to the opposite side of the object</span>
<span class="n">xyzrpy</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">move_to_pose</span><span class="p">(</span><span class="n">moveit_tools</span><span class="o">.</span><span class="n">create_pose</span><span class="p">(</span><span class="n">xyzrpy</span><span class="p">),</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>

<span class="c1"># move to the top of the object</span>
<span class="n">xyzrpy</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">move_to_pose</span><span class="p">(</span><span class="n">moveit_tools</span><span class="o">.</span><span class="n">create_pose</span><span class="p">(</span><span class="n">xyzrpy</span><span class="p">),</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference external image-reference" href="assets/ArmCommander-AvoidObject2.gif"><img alt="Animation" src="assets/ArmCommander-AvoidObject2.gif" /></a>
<p>Another <code class="docutils literal notranslate"><span class="pre">OrientationConstraint</span></code> has been commented out, try using it to replace the current one and observe the difference.</p>
<p>The program file <code class="docutils literal notranslate"><span class="pre">/collision/avoid_object_fix_region.py</span></code> illustrates the use of two different <code class="docutils literal notranslate"><span class="pre">PositionConstraint</span></code> objects. The first one allows the end-effector to pass over the object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># add an positional path constraint to restrict the end-effector to move within the bbox below, which is the nearer side of the object</span>
<span class="n">allowed_bbox</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">add_path_constraints</span><span class="p">(</span><span class="n">moveit_tools</span><span class="o">.</span><span class="n">create_position_constraint_from_bbox</span><span class="p">(</span><span class="n">arm_commander</span><span class="o">.</span><span class="n">get_end_effector_link</span><span class="p">(),</span>
            <span class="n">arm_commander</span><span class="o">.</span><span class="n">get_world_reference_frame</span><span class="p">(),</span> <span class="n">allowed_bbox</span><span class="p">))</span>

<span class="c1"># move to the opposite side of the object</span>
<span class="n">xyzrpy</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">move_to_pose</span><span class="p">(</span><span class="n">moveit_tools</span><span class="o">.</span><span class="n">create_pose</span><span class="p">(</span><span class="n">xyzrpy</span><span class="p">),</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
</pre></div>
</div>
<p>The second one allows the end-effector to move in front of the object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># clear the current positional path constraint and add another positional path constraint</span>
<span class="c1"># to restrict the end-effector to move within the bbox below, which is the outer side of the object</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">clear_path_constraints</span><span class="p">()</span>
<span class="n">allowed_bbox</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">add_path_constraints</span><span class="p">(</span><span class="n">moveit_tools</span><span class="o">.</span><span class="n">create_position_constraint_from_bbox</span><span class="p">(</span><span class="n">arm_commander</span><span class="o">.</span><span class="n">get_end_effector_link</span><span class="p">(),</span>
            <span class="n">arm_commander</span><span class="o">.</span><span class="n">get_world_reference_frame</span><span class="p">(),</span> <span class="n">allowed_bbox</span><span class="p">))</span>

<span class="c1"># move to above the object</span>
<span class="n">xyzrpy</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">move_to_pose</span><span class="p">(</span><span class="n">moveit_tools</span><span class="o">.</span><span class="n">create_pose</span><span class="p">(</span><span class="n">xyzrpy</span><span class="p">),</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">arm_commander</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference external image-reference" href="assets/ArmCommander-AvoidObject3.gif"><img alt="Animation" src="assets/ArmCommander-AvoidObject3.gif" /></a>
</section>
<section id="links">
<h2>Links<a class="headerlink" href="#links" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="../README.md">Overview: The Arm Commander Package</a></p></li>
<li><p><a class="reference external" href="TUTORIAL_PART1.md">Tutorial: Programming with the Arm Commander Package (Part 1)</a></p></li>
</ul>
</section>
<section id="author">
<h2>Author<a class="headerlink" href="#author" title="Permalink to this heading"></a></h2>
<p>Dr Andrew Lui, Senior Research Engineer <span class="raw-html-m2r"><br /></span>
Robotics and Autonomous Systems, Research Engineering Facility <span class="raw-html-m2r"><br /></span>
Research Infrastructure <span class="raw-html-m2r"><br /></span>
Queensland University of Technology <span class="raw-html-m2r"><br /></span></p>
<p>Latest update: Feb 2024</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="arm_commander_tutorial_part1.html" class="btn btn-neutral float-left" title="Tutorial: Programming with the Arm Commander Package (Part 1)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Andrew Lui.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>